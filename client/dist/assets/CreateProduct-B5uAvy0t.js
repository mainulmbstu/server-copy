import{j as e,P as C,r as m,u as f,L as w,h as P,B as y,A as L}from"./index-DFCu50re.js";const E=()=>e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("div",{}),e.jsx("div",{className:"modal fade",id:"createProduct",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"exampleModalLabel",children:"Create new product"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx(C,{})})]})})})]})}),q=()=>{var b,N;let[n,u]=m.useState(!1),[v,h]=m.useState(!0);const[t,c]=m.useState({name:"",description:"",category:"",price:"",quantity:"",picture:"",shipping:""});let{token:x,getProducts:j,category:g,editData:s,setEditData:p}=f();s!=null&&s.name&&v&&(c({name:s.name,description:s.description,category:s.category._id,price:s.price,quantity:s.quantity,picture:"",shipping:s.shipping}),h(!1));let i=r=>{let{name:a,value:l}=r.target;c(d=>({...d,[a]:l}))},o=async r=>{var l;r.preventDefault();let a=new FormData;t!=null&&t.picture&&a.append("picture",t==null?void 0:t.picture,(l=t==null?void 0:t.picture)==null?void 0:l.name),a.append("name",t.name),a.append("description",t.description),a.append("category",t.category),a.append("price",t.price),a.append("quantity",t.quantity),a.append("shipping",t.shipping);try{await u(!0);let{data:d}=await P.post(`https://mernecom-server.onrender.com/products/update-product/${s._id}`,a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${x}`}});d.success?(y.success(d.msg),c({name:"",description:"",category:"",price:"",quantity:"",picture:"",shipping:""}),h(!0),p([]),await j(),u(!1)):y.error(d.msg)}catch(d){console.log({msg:"update product",error:d})}};return e.jsx(w,{title:"Product list",children:e.jsx("div",{className:"row  ",children:e.jsx("div",{className:" p-2",children:e.jsx("div",{className:"card p-2",children:e.jsx("div",{className:" border",children:e.jsxs("form",{onSubmit:o,className:"px-4",encType:"multipart/form-data",children:[e.jsx("input",{onChange:i,className:" form-control mb-2",type:"text",name:"name",value:t.name,placeholder:"Enter product name"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("input",{className:"form-control",list:"categoryList",type:"text",placeholder:(b=s==null?void 0:s.category)==null?void 0:b.name,onChange:r=>{let a=g.filter(l=>l.slug===r.target.value);c(l=>{var d;return{...l,category:(d=a[0])==null?void 0:d._id}})}}),e.jsx("datalist",{id:"categoryList",children:g.map(r=>e.jsx("option",{value:r.slug},r._id))})]}),e.jsx("input",{onChange:i,className:" form-control mb-2",type:"number",name:"price",value:t.price,placeholder:"Enter price"}),e.jsx("input",{onChange:i,className:" form-control mb-2",type:"number",name:"quantity",value:t.quantity,placeholder:"Enter quantity"}),e.jsxs("div",{className:"input-group mb-3",children:[e.jsx("label",{className:"input-group-text",htmlFor:"shipping",children:"Shipping"}),e.jsxs("select",{name:"shipping",onChange:r=>c(a=>({...a,shipping:r.target.value})),className:"form-select",id:"shipping",children:[e.jsxs("option",{children:[t.shipping?"Yes":"No"," "]}),e.jsx("option",{value:"0",children:"No"}),e.jsx("option",{value:"1",children:"Yes"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pic",className:"btn",children:"Upload product image"}),e.jsx("input",{className:" form-control mb-2",id:"pic",type:"file",name:"picture",accept:"image/*",onChange:r=>{i({target:{name:"picture",value:r.target.files[0]}})}})]}),e.jsxs("div",{className:"mb-4 ms-2 d-flex justify-content-evenly",children:[t.picture&&e.jsxs("div",{children:[e.jsx("p",{children:"New uploaded"}),e.jsx("img",{src:URL.createObjectURL(t.picture),alt:"image",className:"img img-responsive",height:"100px"})]}),e.jsxs("div",{children:[e.jsx("p",{children:"Current Image"}),e.jsx("img",{src:(N=s==null?void 0:s.picture)==null?void 0:N.secure_url,alt:"image",className:"img img-responsive",height:"100px"})]})]}),e.jsx("textarea",{onChange:i,className:" form-control mb-2",type:"text",rows:"4",name:"description",value:t.description,placeholder:"Enter product description"}),e.jsxs("div",{className:" d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn  btn-danger text-white fs-5 w-25 ms-2 btn-outline-dark","data-bs-dismiss":"modal",children:"Close"}),n?e.jsx(e.Fragment,{children:e.jsxs("button",{className:"btn btn-primary w-50 fs-5 ms-2",type:"button",disabled:!0,children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"}),"Uploadin data..."]})}):e.jsx(e.Fragment,{children:e.jsx("button",{className:" btn  btn-primary text-white fs-5 w-50 ms-2 btn-outline-dark",type:"submit",children:"Update Product"})})]})]})})})})})})},I=()=>e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("div",{}),e.jsx("div",{className:"modal fade",id:"editProduct",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"exampleModalLabel",children:"Edit product"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsx(q,{})})]})})})]})}),_=()=>{let{products:n,token:u,getProducts:v,getEditData:h}=f();const[t,c]=m.useState([]);let[x,j]=m.useState(!1),g=async(s,p,i)=>{j(!0),c(i);let o=await fetch(`https://mernecom-server.onrender.com/products/delete-product/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${u}`}}),b=await o.json();o.ok?(v(),y.success(`${p} is deleted successfully`),j(!1)):y.success(b.msg)};return e.jsx(w,{title:"Products",children:e.jsxs("div",{className:"row ",children:[e.jsx("div",{className:"col-md-3 p-2",children:e.jsx("div",{className:"card p-2",children:e.jsx(L,{})})}),e.jsx("div",{className:" col-md-9 p-2",children:e.jsx("div",{className:" card p-2",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:" d-flex justify-content-between mb-3",children:[e.jsxs("h3",{children:["Product List (",n.length,") "]}),e.jsxs("div",{children:[e.jsx("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#createProduct",children:"Create Product"}),e.jsx(E,{})]})]}),e.jsx("div",{className:" border",children:e.jsxs("table",{className:"table table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"SL"}),e.jsx("th",{scope:"col",children:"Image"}),e.jsx("th",{scope:"col",children:"Name"}),e.jsx("th",{scope:"col",children:"Category"}),e.jsx("th",{scope:"col",children:"Price"}),e.jsx("th",{scope:"col",children:"Quantity"}),e.jsx("th",{scope:"col",children:"Action"})]})}),e.jsx("tbody",{children:(n==null?void 0:n.length)>0&&n.map((s,p)=>{var i,o;return e.jsxs("tr",{children:[e.jsx("td",{children:p+1}),e.jsx("td",{children:e.jsx("img",{src:`${(i=s==null?void 0:s.picture)==null?void 0:i.secure_url}`,alt:"",width:"30"})}),e.jsx("td",{children:s.name}),e.jsx("td",{children:(o=s.category)==null?void 0:o.slug}),e.jsx("td",{children:s.price}),e.jsx("td",{children:s.quantity}),e.jsxs("td",{children:[e.jsx("button",{onClick:()=>g(s._id,s.name,s),className:"btn btn-danger",disabled:x,children:x&&s._id===t._id?e.jsx(e.Fragment,{children:e.jsx("div",{className:"spinner-border text-primary",role:"status",disabled:!0,children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(e.Fragment,{children:"Delete"})}),e.jsx("button",{onClick:()=>h(s),type:"button",className:"btn btn-primary ms-2","data-bs-toggle":"modal","data-bs-target":"#editProduct",children:"Details & Edit"}),e.jsx(I,{})]})]},s._id)})})]})})]})})})]})})};export{_ as default};
